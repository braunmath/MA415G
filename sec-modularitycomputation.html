<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US" dir="ltr">
<!--******************************************-->
<!--*  Authored with PreTeXt                 *-->
<!--*  pretextbook.org                       *-->
<!--*  Theme: tacoma                         *-->
<!--*  Palette:                              *-->
<!--******************************************-->
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>An Algorithm to (Approximately) Maximize Modularity</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0">
<link href="_static/pretext/css/theme.css" rel="stylesheet" type="text/css">
<script>
var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  "tex": {
    "inlineMath": [
      [
        "\\(",
        "\\)"
      ]
    ],
    "tags": "none",
    "tagSide": "right",
    "tagIndent": ".8em",
    "packages": {
      "[+]": [
        "base",
        "extpfeil",
        "ams",
        "amscd",
        "color",
        "newcommand",
        "knowl"
      ]
    }
  },
  "options": {
    "ignoreHtmlClass": "tex2jax_ignore|ignore-math",
    "processHtmlClass": "process-math"
  },
  "chtml": {
    "scale": 0.98,
    "mtextInheritFont": true
  },
  "loader": {
    "load": [
      "input/asciimath",
      "[tex]/extpfeil",
      "[tex]/amscd",
      "[tex]/color",
      "[tex]/newcommand",
      "[pretext]/mathjaxknowl3.js"
    ],
    "paths": {
      "pretext": "_static/pretext/js/lib"
    }
  },
  "startup": {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
  }
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="MA 415G course notes">
<meta property="book:author" content="Benjamin Braun">
<script src="_static/pretext/js/lib/jquery.min.js"></script><script src="_static/pretext/js/lib/jquery.sticky.js"></script><script src="_static/pretext/js/lib/jquery.espy.min.js"></script><script src="_static/pretext/js/pretext.js"></script><script src="_static/pretext/js/pretext_add_on.js?x=1"></script><script src="_static/pretext/js/user_preferences.js"></script><!--** eBookCongig is necessary to configure interactive       **-->
<!--** Runestone components to run locally in reader's browser **-->
<!--** No external communication:                              **-->
<!--**     log level is 0, Runestone Services are disabled     **-->
<script type="text/javascript">
eBookConfig = {};
eBookConfig.useRunestoneServices = false;
eBookConfig.host = 'http://127.0.0.1:8000';
eBookConfig.course = 'PTX_Course_Title_Here';
eBookConfig.basecourse = 'PTX_Base_Course';
eBookConfig.isLoggedIn = false;
eBookConfig.email = '';
eBookConfig.isInstructor = false;
eBookConfig.logLevel = 0;
eBookConfig.username = '';
eBookConfig.readings = null;
eBookConfig.activities = null;
eBookConfig.downloadsEnabled = false;
eBookConfig.allow_pairs = false;
eBookConfig.enableScratchAC = false;
eBookConfig.build_info = "";
eBookConfig.python3 = null;
eBookConfig.runestone_version = '7.9.17';
eBookConfig.jobehost = '';
eBookConfig.proxyuri_runs = '';
eBookConfig.proxyuri_files = '';
eBookConfig.enable_chatcodes =  false;
</script>
<!--*** Runestone Services ***-->
<script src="_static/prefix-runtime.3ea59cc2563cc8e9.bundle.js"></script><script src="_static/prefix-723.3e6434f80549315a.bundle.js"></script><script src="_static/prefix-runestone.29d986501a531379.bundle.js"></script><link rel="stylesheet" type="text/css" href="_static/prefix-723.3bccd435914aa0ff.css">
<link rel="stylesheet" type="text/css" href="_static/prefix-runestone.557d81b04b3ec0e4.css">
<script src="_static/pretext/js/lti_iframe_resizer.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/components/prism-core.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-numbers/prism-line-numbers.min.js" integrity="sha512-dubtf8xMHSQlExGRQ5R7toxHLgSDZ0K7AunqPWHXmJQ8XyVIG19S1T95gBxlAeGOK02P4Da2RTnQz0Za0H0ebQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-highlight/prism-line-highlight.min.js" integrity="sha512-93uCmm0q+qO5Lb1huDqr7tywS8A2TFA+1/WHvyiWaK6/pvsFl6USnILagntBx8JnVbQH5s3n0vQZY6xNthNfKA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js" integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lunr-pretext-search-index.js" async=""></script><script src="_static/pretext/js/pretext_search.js"></script><script src="_static/pretext/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script>
</head>
<body class="pretext book ignore-math">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead" class="ptx-masthead"><div class="ptx-banner"><div class="title-container">
<h1 class="heading"><a href="ma415g.html"><span class="title">MA 415G course notes</span></a></h1>
<p class="byline">Benjamin Braun</p>
</div></div></header><nav id="ptx-navbar" class="ptx-navbar navbar"><div class="ptx-navbar-contents">
<button class="toc-toggle button" title="Contents"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5d2;</span><span class="name">Contents</span></button><div class="searchbox">
<div class="searchwidget"><button id="searchbutton" class="searchbutton button" type="button" title="Search book"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe8b6;</span><span class="name">Search Book</span></button></div>
<div id="searchresultsplaceholder" class="searchresultsplaceholder" style="display: none">
<div class="search-results-controls">
<input aria-label="Search term" id="ptxsearch" class="ptxsearch" type="text" name="terms" placeholder="Search term"><button title="Close search" id="closesearchresults" class="closesearchresults"><span class="material-symbols-outlined">close</span></button>
</div>
<h2 class="search-results-heading">Search Results: </h2>
<div id="searchempty" class="searchempty"><span>No results.</span></div>
<ol id="searchresults" class="searchresults"></ol>
</div>
</div>
<span class="nav-other-controls"><button id="light-dark-button" class="light-dark-button button" title="Dark Mode"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe51c;</span><span class="name">Dark Mode</span></button></span><span class="treebuttons"><a class="previous-button button" href="sec-modularity.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="up-button button" href="ch-optimization.html" title="Up"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Up</span></a><a class="next-button button" href="ch-ethics.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a></span>
</div></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\newcommand{\inv}{\mathrm{inv}} \newcommand{\deg}{\mathrm{deg}} \newcommand{\des}{\mathrm{des}} \newcommand{\Des}{\mathrm{Des}} \newcommand{\Inv}{\mathrm{Inv}} \newcommand{\N}{\mathbb N} \newcommand{\Z}{\mathbb Z} \newcommand{\Q}{\mathbb Q} \newcommand{\R}{\mathbb R} \newcommand{\Bin}{\mathrm{Bin}} \newcommand{\comp}{\mathrm{Comp}} \newcommand{\ss}{\mathfrak{S}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar" class="ptx-sidebar"><nav id="ptx-toc" class="ptx-toc depth2 focused" data-preexpanded-levels="0" data-max-levels="2"><ul class="structural toc-item-list contains-active">
<li class="toc-item toc-frontmatter"><div class="toc-title-box"><a href="frontmatter.html" class="internal"><span class="title">Front Matter</span></a></div></li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="introduction.html" class="internal"><span class="codenumber">1</span> <span class="title">Introduction</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-foundational-questions.html" class="internal"><span class="codenumber">1.1</span> <span class="title">Eight Foundational Questions</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-Proofs.html" class="internal"><span class="codenumber">1.2</span> <span class="title">Proofs</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="enumeration.html" class="internal"><span class="codenumber">2</span> <span class="title">Enumeration</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-binarystrings.html" class="internal"><span class="codenumber">2.1</span> <span class="title">Binary Strings</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-binomialcoefficients.html" class="internal"><span class="codenumber">2.2</span> <span class="title">Binomial Coefficients</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-fibonacci.html" class="internal"><span class="codenumber">2.3</span> <span class="title">Fibonacci Numbers</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-pauseforenumerationreflection.html" class="internal"><span class="codenumber">2.4</span> <span class="title">Pause for Reflection</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-permutations.html" class="internal"><span class="codenumber">2.5</span> <span class="title">Permutations</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-cycles.html" class="internal"><span class="codenumber">2.6</span> <span class="title">Permutations: Cycle Structure and Derangements</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-inversions.html" class="internal"><span class="codenumber">2.7</span> <span class="title">Permutations: Inversions and Descents</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-induction1.html" class="internal"><span class="codenumber">2.8</span> <span class="title">Induction: Part 1</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-classification.html" class="internal"><span class="codenumber">3</span> <span class="title">Classification</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-classificationproblems.html" class="internal"><span class="codenumber">3.1</span> <span class="title">Classification Problems</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-graphbasics.html" class="internal"><span class="codenumber">3.2</span> <span class="title">Graphs and Networks</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-trees.html" class="internal"><span class="codenumber">3.3</span> <span class="title">Trees</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-euleriancircuits.html" class="internal"><span class="codenumber">3.4</span> <span class="title">Eulerian Circuits</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-prufercayley.html" class="internal"><span class="codenumber">3.5</span> <span class="title">Prufer Codes and Cayleyâ€™s Theorem</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-degreesequences.html" class="internal"><span class="codenumber">3.6</span> <span class="title">Degree Sequences</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-stacksortable.html" class="internal"><span class="codenumber">3.7</span> <span class="title">Stack Sortable Permutations</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-expectation.html" class="internal"><span class="codenumber">4</span> <span class="title">Expectation</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-expectationintro.html" class="internal"><span class="codenumber">4.1</span> <span class="title">Expectation Questions</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-finiteprobability.html" class="internal"><span class="codenumber">4.2</span> <span class="title">Finite Probability Spaces and Random Variables</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-expectationindicators.html" class="internal"><span class="codenumber">4.3</span> <span class="title">Expected Values, Linearity of Expectation, and Indicator Functions</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-expectationsubsets.html" class="internal"><span class="codenumber">4.4</span> <span class="title">Expected Values: Binary Strings and Subsets</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-expectationpermutations.html" class="internal"><span class="codenumber">4.5</span> <span class="title">Expected Values: Permutations</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-expectationgraphs.html" class="internal"><span class="codenumber">4.6</span> <span class="title">Expected Values: Graphs</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter contains-active">
<div class="toc-title-box"><a href="ch-optimization.html" class="internal"><span class="codenumber">5</span> <span class="title">Optimization</span></a></div>
<ul class="structural toc-item-list contains-active">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-optimizationintro.html" class="internal"><span class="codenumber">5.1</span> <span class="title">Optimization Questions</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-matchings.html" class="internal"><span class="codenumber">5.2</span> <span class="title">Maximum Matching in Graphs</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-minimumspanningtrees.html" class="internal"><span class="codenumber">5.3</span> <span class="title">Minimum Spanning Trees in Weighted Graphs</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-modularitymaximization.html" class="internal"><span class="codenumber">5.4</span> <span class="title">Intro to Modularity Maximization in Networks and Community Detection</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-configuration.html" class="internal"><span class="codenumber">5.5</span> <span class="title">The Configuration Model for Random Networks</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-modularity.html" class="internal"><span class="codenumber">5.6</span> <span class="title">Communities via Modularity Maximization</span></a></div></li>
<li class="toc-item toc-section active"><div class="toc-title-box"><a href="sec-modularitycomputation.html" class="internal"><span class="codenumber">5.7</span> <span class="title">An Algorithm to (Approximately) Maximize Modularity</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter"><div class="toc-title-box"><a href="ch-ethics.html" class="internal"><span class="codenumber">6</span> <span class="title">Ethics</span></a></div></li>
<li class="toc-item toc-chapter"><div class="toc-title-box"><a href="ch-samplingandconstruction.html" class="internal"><span class="codenumber">7</span> <span class="title">Sampling and Construction</span></a></div></li>
<li class="toc-item toc-chapter"><div class="toc-title-box"><a href="ch-existence.html" class="internal"><span class="codenumber">8</span> <span class="title">Existence</span></a></div></li>
<li class="toc-item toc-chapter"><div class="toc-title-box"><a href="ch-estimation.html" class="internal"><span class="codenumber">9</span> <span class="title">Estimation</span></a></div></li>
<li class="toc-item toc-chapter"><div class="toc-title-box"><a href="ch-homework.html" class="internal"><span class="codenumber">10</span> <span class="title">Homework Problems and Essays</span></a></div></li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content"><section class="section" id="sec-modularitycomputation"><h2 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber">5.7</span><span class="space"> </span><span class="title">An Algorithm to (Approximately) Maximize Modularity</span>
</h2>
<div class="para" id="sec-modularitycomputation-2">We have now developed a well-defined problem to solve in order to optimally split a network into one or two communities.<div class="autopermalink" data-description="Paragraph"><a href="#sec-modularitycomputation-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para logical" id="sec-modularitycomputation-3">
<div class="para">
<em class="emphasis">Problem:</em> Given a network <span class="process-math">\(G=(V,E)\)</span> where <span class="process-math">\(V=\{1,2,\ldots,n\}\)</span> and <span class="process-math">\(|E|=m\text{,}\)</span> find the vertex partition <span class="process-math">\(V=V_1\uplus V_2\)</span> (where it is possible for one of these sets to be empty) that maximizes the modularity function</div>
<div class="displaymath process-math">
\begin{equation*}
Q := \frac{1}{2m} \sum_{1\leq i,j \leq n} \left( A_{i,j} - \frac{d_i d_j}{2m} \right) \delta_{g_i,g_j} \, .
\end{equation*}
</div>
<div class="para">over the set of all such vertex partitions.</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-modularitycomputation-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="sec-modularitycomputation-4">There are many general approaches that have been developed for this type of discrete optimization problem, such as simulated annealing, genetic algorithms, extremal optimization, etc. In practice, it is very difficult to develop an algorithm that is both efficient and produces the actual maximizer. Instead, most algorithms to solve this optimization problem only provide approximate maximizers -- this is usually good enough in practice.<div class="autopermalink" data-description="Paragraph"><a href="#sec-modularitycomputation-4" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="sec-modularitycomputation-5">We will consider a simple algorithm to provide an approximate solution to this optimization problem that is specific to modularity maximization, rather than general-purpose discrete optimization algorithms. The method we will consider was introduced by Newman in 2006 in the paper "Modularity and community structure in networks" <a class="external" href="https://www.pnas.org/doi/10.1073/pnas.0601602103" target="_blank"><code class="code-inline tex2jax_ignore">https://www.pnas.org/doi/10.1073/pnas.0601602103</code></a>. This method is most effective when combined into a two-stage method, where the first stage uses "spectral methods" involving eigenvector calculations for the modularity matrix <span class="process-math">\(B=[B_{i,j}]\)</span> to find an initial approximate solution, and the node-moving algorithm described below is the second step to make small adjustments to improve the solution found with the spectral method.<div class="autopermalink" data-description="Paragraph"><a href="#sec-modularitycomputation-5" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<article class="definition definition-like" id="def-nodemovingmodularity"><h3 class="heading">
<span class="type">Definition</span><span class="space"> </span><span class="codenumber">5.7.1</span><span class="period">.</span><span class="space"> </span><span class="title">Node-Moving Algorithm.</span>
</h3>
<div class="para logical" id="def-nodemovingmodularity-2-1">
<div class="para">Let <span class="process-math">\(G\)</span> be a network.</div>
<ol class="decimal" id="def-nodemovingmodularity-2-1-2">
<li id="def-nodemovingmodularity-2-1-2-1">
<div class="para" id="def-nodemovingmodularity-2-1-2-1-1">Select a random partition of the vertices <span class="process-math">\(V=V_1\uplus V_2\)</span> into roughly equally-sized groups.<div class="autopermalink" data-description="Paragraph"><a href="#def-nodemovingmodularity-2-1-2-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Item 1"><a href="#def-nodemovingmodularity-2-1-2-1" title="Copy heading and permalink for Item 1" aria-label="Copy heading and permalink for Item 1">ðŸ”—</a></div>
</li>
<li id="def-nodemovingmodularity-2-1-2-2">
<div class="para" id="def-nodemovingmodularity-2-1-2-2-1">A <em class="emphasis">pass</em> of the node-moving algorithm is defined as follows.<div class="autopermalink" data-description="Paragraph"><a href="#def-nodemovingmodularity-2-1-2-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<ol class="lower-alpha lower-alpha-level-1" id="def-nodemovingmodularity-2-1-2-2-2">
<li id="def-nodemovingmodularity-2-1-2-2-2-1">
<div class="para" id="def-nodemovingmodularity-2-1-2-2-2-1-1">For each node in the network, calculate the change in the modularity if that node were moved to the other set in the partition.<div class="autopermalink" data-description="Paragraph"><a href="#def-nodemovingmodularity-2-1-2-2-2-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Item 2.a"><a href="#def-nodemovingmodularity-2-1-2-2-2-1" title="Copy heading and permalink for Item 2.a" aria-label="Copy heading and permalink for Item 2.a">ðŸ”—</a></div>
</li>
<li id="def-nodemovingmodularity-2-1-2-2-2-2">
<div class="para" id="def-nodemovingmodularity-2-1-2-2-2-2-1">Select the node that most increases (or least decreases) the modularity and move it.<div class="autopermalink" data-description="Paragraph"><a href="#def-nodemovingmodularity-2-1-2-2-2-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Item 2.b"><a href="#def-nodemovingmodularity-2-1-2-2-2-2" title="Copy heading and permalink for Item 2.b" aria-label="Copy heading and permalink for Item 2.b">ðŸ”—</a></div>
</li>
<li id="def-nodemovingmodularity-2-1-2-2-2-3">
<div class="para" id="def-nodemovingmodularity-2-1-2-2-2-3-1">Repeat the first two steps, however, you are not allowed to move a node once it has been moved during the pass.<div class="autopermalink" data-description="Paragraph"><a href="#def-nodemovingmodularity-2-1-2-2-2-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Item 2.c"><a href="#def-nodemovingmodularity-2-1-2-2-2-3" title="Copy heading and permalink for Item 2.c" aria-label="Copy heading and permalink for Item 2.c">ðŸ”—</a></div>
</li>
<li id="def-nodemovingmodularity-2-1-2-2-2-4">
<div class="para" id="def-nodemovingmodularity-2-1-2-2-2-4-1">After all nodes have been moved, the pass ends.<div class="autopermalink" data-description="Paragraph"><a href="#def-nodemovingmodularity-2-1-2-2-2-4-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Item 2.d"><a href="#def-nodemovingmodularity-2-1-2-2-2-4" title="Copy heading and permalink for Item 2.d" aria-label="Copy heading and permalink for Item 2.d">ðŸ”—</a></div>
</li>
</ol>
<div class="autopermalink" data-description="Item 2"><a href="#def-nodemovingmodularity-2-1-2-2" title="Copy heading and permalink for Item 2" aria-label="Copy heading and permalink for Item 2">ðŸ”—</a></div>
</li>
<li id="def-nodemovingmodularity-2-1-2-3">
<div class="para" id="def-nodemovingmodularity-2-1-2-3-1">At the completion of one pass, go through all of the partitions obtained during that pass (including the original partition) and select the partition <span class="process-math">\(V=W_1\uplus W_2\)</span> with the maximum modularity.<div class="autopermalink" data-description="Paragraph"><a href="#def-nodemovingmodularity-2-1-2-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<ol class="lower-alpha lower-alpha-level-1" id="def-nodemovingmodularity-2-1-2-3-2">
<li id="def-nodemovingmodularity-2-1-2-3-2-1">
<div class="para" id="def-nodemovingmodularity-2-1-2-3-2-1-1">If the partition <span class="process-math">\(V_1\uplus V_2\)</span> is different than <span class="process-math">\(W_1\uplus W_2\text{,}\)</span> repeat another pass using <span class="process-math">\(W_1\uplus W_2\)</span> as the starting partition.<div class="autopermalink" data-description="Paragraph"><a href="#def-nodemovingmodularity-2-1-2-3-2-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Item 3.a"><a href="#def-nodemovingmodularity-2-1-2-3-2-1" title="Copy heading and permalink for Item 3.a" aria-label="Copy heading and permalink for Item 3.a">ðŸ”—</a></div>
</li>
<li id="def-nodemovingmodularity-2-1-2-3-2-2">
<div class="para" id="def-nodemovingmodularity-2-1-2-3-2-2-1">If the partition <span class="process-math">\(V_1\uplus V_2\)</span> is the same as <span class="process-math">\(W_1\uplus W_2\text{,}\)</span> then we cannot improve the modularity with a pass, and the algorithm terminates with <span class="process-math">\(W_1\uplus W_2\)</span> as output.<div class="autopermalink" data-description="Paragraph"><a href="#def-nodemovingmodularity-2-1-2-3-2-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Item 3.b"><a href="#def-nodemovingmodularity-2-1-2-3-2-2" title="Copy heading and permalink for Item 3.b" aria-label="Copy heading and permalink for Item 3.b">ðŸ”—</a></div>
</li>
</ol>
<div class="autopermalink" data-description="Item 3"><a href="#def-nodemovingmodularity-2-1-2-3" title="Copy heading and permalink for Item 3" aria-label="Copy heading and permalink for Item 3">ðŸ”—</a></div>
</li>
</ol>
<div class="autopermalink" data-description="Paragraph"><a href="#def-nodemovingmodularity-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Definition 5.7.1: Node-Moving Algorithm"><a href="#def-nodemovingmodularity" title="Copy heading and permalink for Definition 5.7.1: Node-Moving Algorithm" aria-label="Copy heading and permalink for Definition 5.7.1: Node-Moving Algorithm">ðŸ”—</a></div></article><div class="para" id="sec-modularitycomputation-7">For anyone who is interested in seeing how this looks in code, here is a sample of Sagemath code that you can use in <a class="external" href="https://sagecell.sagemath.org/" target="_blank"><code class="code-inline tex2jax_ignore">https://sagecell.sagemath.org/</code></a>. This code snippet will run the node-moving algorithm on a random graph from the configuration model with a degree sequence of your choice.<div class="autopermalink" data-description="Paragraph"><a href="#sec-modularitycomputation-7" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="code-box"><pre class="program clipboardable"><code class="language-py">import networkx as nx

def nodemove(V,i):
    W = []
    if i in V[0]:
        W=[]
        W.append([j for j in V[0] if j != i])
        W.append([i]+V[1])
    else:
        W=[]
        W.append([i]+V[0])
        W.append([j for j in V[1] if j != i])
    return(W)

def mostdiffnode(G,V,checked):
    maxdiff = -100
    for i in Graph(G).vertices():
        if i not in checked:
            if N(nx.community.modularity(G,nodemove(V,i))) - N(nx.community.modularity(G,V)) &gt; maxdiff:
                maxvert = i
                maxdiff = N(nx.community.modularity(G,nodemove(V,i))) - N(nx.community.modularity(G,V))
    return(maxvert)

def nodepasspartitions(G,V):
    n = len(Graph(G).vertices())
    parts = [V]
    checked = []
    while n &gt; len(checked):
        t = mostdiffnode(G,parts[-1],checked)
        parts.append(nodemove(parts[-1],t))
        checked.append(t)
    return(parts)

def largestmodpart(G,parts):
    mod = -100
    for W in parts:
        if N(nx.community.modularity(G,W)) &gt; mod:
            largestpart = W
            mod = N(nx.community.modularity(G,W))
    return(largestpart)

D = [4,8,2,2,5,7,5,3,3,2,4,5,4,8,8,2,2,2,4]

G = nx.configuration_model(D)

V = [[i for i in range(floor(len(D)/2))],[i for i in range(floor(len(D)/2),len(D))]]

W = largestmodpart(G,nodepasspartitions(G,V))

while sorted([sorted(V[0]),sorted(V[1])]) != sorted([sorted(W[0]),sorted(W[1])]):
    W1 = largestmodpart(G,nodepasspartitions(G,W))
    V = W
    W = W1

Graph(G).show(layout='circular')
print(sorted([sorted(W[0]),sorted(W[1])]))
print('estimated max modularity is '+str(N(nx.community.modularity(G,W))))
</code></pre></div>
<details id="sec-modularitycomputation-9" class="exercise exercise-like born-hidden-knowl"><summary class="knowl__link"><h3 class="heading">
<span class="type">Checkpoint</span><span class="space"> </span><span class="codenumber">5.7.2</span><span class="period">.</span>
</h3></summary><article class="exercise exercise-like knowl__content"><div class="para" id="sec-modularitycomputation-9-1">Discuss the algorithm above. Does it make sense?<div class="autopermalink" data-description="Paragraph"><a href="#sec-modularitycomputation-9-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="para" id="sec-modularitycomputation-9-2">Run this algorithm on the graph below starting from the partition <span class="process-math">\(V_1=\{0,1\}, V_2=\{3,4\}\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-modularitycomputation-9-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<figure class="figure figure-like" id="nodemovingexercise"><div class="image-box" style="width: 75%; margin-left: 12.5%; margin-right: 12.5%;"><img src="external/modularitynodemovingexample.png" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">5.7.3<span class="period">.</span></span><span class="space"> </span>Graph for the node-moving algorithm checkpoint.<div class="autopermalink" data-description="Figure 5.7.3"><a href="#nodemovingexercise" title="Copy heading and permalink for Figure 5.7.3" aria-label="Copy heading and permalink for Figure 5.7.3">ðŸ”—</a></div></figcaption></figure><div class="para" id="sec-modularitycomputation-9-4">You should find that the algorithm terminates at the partition <span class="process-math">\(W_1=\{0,2\}, W_2=\{1,3\}\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-modularitycomputation-9-4" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Checkpoint 5.7.2"><a href="#sec-modularitycomputation-9" title="Copy heading and permalink for Checkpoint 5.7.2" aria-label="Copy heading and permalink for Checkpoint 5.7.2">ðŸ”—</a></div></article></details><div class="para" id="sec-modularitycomputation-10">Note that there is no guarantee that the result of this algorithm is actually a maximizer for modularity -- however, it does provide a way to generate a partition with higher modularity than you started with. There are many interesting algorithms for maximizing modularity, and there are many other approaches beyond modularity to the study of community detection. So, you should view what we have done as an invitation to further study rather than as a comprehensive survey.<div class="autopermalink" data-description="Paragraph"><a href="#sec-modularitycomputation-10" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">ðŸ”—</a></div>
</div>
<div class="autopermalink" data-description="Section 5.7: An Algorithm to (Approximately) Maximize Modularity"><a href="#sec-modularitycomputation" title="Copy heading and permalink for Section 5.7: An Algorithm to (Approximately) Maximize Modularity" aria-label="Copy heading and permalink for Section 5.7: An Algorithm to (Approximately) Maximize Modularity">ðŸ”—</a></div></section></div>
<div id="ptx-content-footer" class="ptx-content-footer">
<a class="previous-button button" href="sec-modularity.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Top</span></a><a class="next-button button" href="ch-ethics.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a>
</div></main>
</div>
<div id="ptx-page-footer" class="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org" title="PreTeXt"><div class="logo"><svg xmlns="http://www.w3.org/2000/svg" height="100%" viewBox="338 3000 8772 6866" role="img"><title>PreTeXt logo</title><g style="stroke-width:.025in; stroke:currentColor; fill:none"><polyline points="472,3590 472,9732 " style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259"></path><path style="stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0   472  9732"></path><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,3496  A 4241 4241  0  0  1  4724  3590"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,9259  A 4507 4507  0  0  1  4724  9448"></path><polyline points="5385,4299 4062,8125" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8598,3496 8598,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="850,3496 850,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="4960,9685 4488,9685" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="3070,4582 1889,6141 3070,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="6418,4582 7600,6141 6418,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8976,3590 8976,9732" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><path style="stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732"></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy" title="Runestone Academy"><img class="logo" src="https://runestone.academy/runestone/static/images/RAIcon_cropped.png" alt="Runstone Academy logo"></a><a class="mathjax-link" href="https://www.mathjax.org" title="MathJax"><img class="logo" src="https://www.mathjax.org/badge/badge-square-2.png" alt="MathJax logo"></a>
</div>
</body>
</html>
